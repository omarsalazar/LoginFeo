<!DOCTYPE html>

<!-- define angular app -->
<html>
{% load staticfiles %}
{% load static %}
<head>
  <!-- SCROLLS -->
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
  <link rel="stylesheet" href="{% static 'css/custom.css' %}" />
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.0/css/font-awesome.css" />
  <title>Junosty</title>
<script src="https://code.jquery.com/jquery-2.2.4.min.js"   integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="   crossorigin="anonymous"></script>
  <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/3.2.1/firebase.js"></script>
  <script>
	var config = {
        apiKey: "AIzaSyAYauqF86mGkJgNeeocAnwIrdOqvpVYyzI",
        authDomain: "ving-328c9.firebaseapp.com",
        databaseURL: "https://ving-328c9.firebaseio.com",
        storageBucket: "gs://ving-328c9.appspot.com",
      };
      var uid = '';
      firebase.initializeApp(config);
      function enviando(){
          //console.log("shimon" + jQuery('#cotiza').val())
          email = $('#email').val();
          password = $('#pass').val();
          name = $('#materiaalerta').val();
          last_name = $('#apregistro').val();
          boleta = $('#boletaregistro').val();
          console.log(email);
          console.log(password);
          console.log(name);
          console.log(last_name);
          console.log(boleta);
        // var ref = new firebase.database().ref().child('Users');
        //     ref.push({
        //       Nombre: 'holis',
        //       Boleta: '212321',
        //     });

        firebase.auth().createUserWithEmailAndPassword(email, password).catch(function(error) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // [START_EXCLUDE]
          if (errorCode == 'auth/weak-password') {
            alert('The password is too weak.');
          } else {
            alert(errorMessage);
          }
          else if (error == null){
              console.log('todo oc ');
          }
          console.log('todo oc mami');
          console.log(error);
          // [END_EXCLUDE]
        });
        firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error, authData) {
          // Handle Errors here.
          var errorCode = error.code;
          var errorMessage = error.message;
          // [START_EXCLUDE]
          if (errorCode === 'auth/wrong-password') {
            alert('Wrong password.');
          } else {
            alert(errorMessage);
          }
          if(error == null){
              alert('no hubo ningun error');
              uid = authData.uid;
          }
          console.log(error);

          // [END_EXCLUDE]
        });
        var ref = new firebase.database().ref().child('Users').child(uid);
            ref.set({
              nombre: name,
              apellidos: last_name,
              boleta: boleta,
              contrasena: password
            });
        firebase.auth().signOut();


      }
</script>
  <!-- SPELLS -->
  <!-- <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular-route.js"></script>
  <script src="{% static 'script.js' %}"></script> -->
</head>

<!-- define controlador de angular -->
<body>

  <nav class="navbar navbar-default">
    <div class="container">
      <div class="navbar-header">
        <a class="navbar-brand">Junosty</a>
      </div>

      <ul class="nav navbar-nav navbar-right">
        {% if user.is_authenticated %}
        <li><a href="/usuario/perfil"><i class="fa fa-user"></i> Perfil</a></li>
        <li><a href="/materia/horario"><i class="fa fa-pencil"></i> Materias</a></li>
        <li><a href="/semestre/horario"><i class="fa fa-clock-o"></i> Horario</a></li>
        <li><a href="/tarea/alertas"><i class="fa fa-bell"></i> Tareas</a></li>
        <li><a href="/examen/alertas"><i class="fa fa-bell"></i> Examenes</a></li>
        <li><a href="/usuario/logout"><i class="fa fa-user"></i> Cerrar Sesion</a></li>
        {%else%}
        <li><a href="/usuario/index"><i class = "fa fa-circle-o"></i> Inicio</a></li>
        {% endif %}

      </ul>
    </div>
  </nav>

  <div id="main" class="container">

    <!-- modelado de angular -->
		<!-- aquí es donde se inyectará el codigo -->
    <!-- <div ng-view></div> -->
    {% block content %}{% endblock content %}
  </div>
	<button onclick="enviando();">Hola</button>

</body>

</html>
